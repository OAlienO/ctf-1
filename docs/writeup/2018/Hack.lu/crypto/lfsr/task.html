<!DOCTYPE HTML><html lang=""><head><meta charset="UTF-8"><meta content="text/html; charset=utf-8"http-equiv="Content-Type"><title>task description Â· GitBook</title><meta content="IE=edge"http-equiv="X-UA-Compatible"/><meta content=""name="description"><meta content="GitBook 3.2.3"name="generator"><link href="../../../../../gitbook/style.css"rel="stylesheet"><link href="../../../../../gitbook/gitbook-plugin-katex/katex.min.css"rel="stylesheet"><link href="../../../../../gitbook/gitbook-plugin-disqus/plugin.css"rel="stylesheet"><link href="../../../../../gitbook/gitbook-plugin-prism/prism-tomorrow.css"rel="stylesheet"><link href="../../../../../gitbook/gitbook-plugin-writeup-utils/plugin.css"rel="stylesheet"><link href="../../../../../gitbook/gitbook-plugin-search/search.css"rel="stylesheet"><link href="../../../../../gitbook/gitbook-plugin-fontsettings/website.css"rel="stylesheet"><meta content="true"name="HandheldFriendly"/><meta content="width=device-width,initial-scale=1,user-scalable=no"name="viewport"><meta content="yes"name="apple-mobile-web-app-capable"><meta content="black"name="apple-mobile-web-app-status-bar-style"><link href="../../../../../gitbook/images/apple-touch-icon-precomposed-152.png"rel="apple-touch-icon-precomposed"sizes="152x152"><link href="../../../../../gitbook/images/favicon.ico"rel="shortcut icon"type="image/x-icon"><link href="./"rel="prev"/></head><body><div class="book"><div class="book-summary"><div role="search"id="book-search-input"><input placeholder="Type to search"type="text"/></div><nav role="navigation"><ul class="summary"><li class="chapter"data-level="1.1"data-path="../../../../../"><a href="../../../../../">Introduction</a></li><li class="header">Writeups</li><li class="header">2018</li><li class="chapter"data-level="3.1"><span>hxp</span><ul class="articles"><li class="chapter"data-level="3.1.1"data-path="../../../hxp/crypto/curve/"><a href="../../../hxp/crypto/curve/">crypto - curve12833227</a></li><li class="chapter"data-level="3.1.2"data-path="../../../hxp/crypto/oops/"><a href="../../../hxp/crypto/oops/">crypto - oops2</a></li><li class="chapter"data-level="3.1.3"data-path="../../../hxp/crypto/blind/"><a href="../../../hxp/crypto/blind/">crypto - blind</a></li></ul></li><li class="chapter"data-level="3.2"><span>Pwn2Win</span><ul class="articles"><li class="chapter"data-level="3.2.1"data-path="../../../pwn2win/rev/back_to_bletchley_park/"><a href="../../../pwn2win/rev/back_to_bletchley_park/">cryrev - Back To Bletchley Park</a></li><li class="chapter"data-level="3.2.2"data-path="../../../pwn2win/crypto/GCM/"><a href="../../../pwn2win/crypto/GCM/">crypto - GCM</a></li></ul></li><li class="chapter"data-level="3.3"><span>HITCON</span><ul class="articles"><li class="chapter"data-level="3.3.1"data-path="../../../hitcon/crypto/lostmod/"><a href="../../../hitcon/crypto/lostmod/">crypto - Lost Modulus</a></li><li class="chapter"data-level="3.3.2"data-path="../../../hitcon/crypto/secret/"><a href="../../../hitcon/crypto/secret/">crypwn - Secret Note</a></li></ul></li><li class="chapter"data-level="3.4"><span>Hack.lu</span><ul class="articles"><li class="chapter"data-level="3.4.1"data-path="../escape/"><a href="../escape/">crypto - Escape the Grid</a></li><li class="chapter"data-level="3.4.2"data-path="../relation/"><a href="../relation/">crypto - Relations</a></li><li class="chapter"data-level="3.4.3"data-path="./"><a href="./">crypto - LFSR StreamCipher</a><ul class="articles"><li class="chapter active"data-level="3.4.3.1"data-path="task.html"><a href="task.html">task description</a></li></ul></li></ul></li><li class="chapter"data-level="3.5"><span>Hackover</span><ul class="articles"><li class="chapter"data-level="3.5.1"data-path="../../../HackOver/crypto/oblivious/"><a href="../../../HackOver/crypto/oblivious/">crypto - oblivious</a></li><li class="chapter"data-level="3.5.2"data-path="../../../HackOver/crypto/secure_hash_v2/"><a href="../../../HackOver/crypto/secure_hash_v2/">crypto - secure_hash_v2</a></li><li class="chapter"data-level="3.5.3"data-path="../../../HackOver/rev/flagmaker/"><a href="../../../HackOver/rev/flagmaker/">rev - flagmaker</a></li></ul></li><li class="chapter"data-level="3.6"><span>Teaser Dragon</span><ul class="articles"><li class="chapter"data-level="3.6.1"data-path="../../../TeaserDragon/rev/Chains of trust/"><a href="../../../TeaserDragon/rev/Chains of trust/">rev - Chains of trust</a></li></ul></li><li class="chapter"data-level="3.7"><span>Defcamp</span><ul class="articles"><li class="chapter"data-level="3.7.1"data-path="../../../defcamp/rev/validator/"><a href="../../../defcamp/rev/validator/">rev - validator</a></li><li class="chapter"data-level="3.7.2"data-path="../../../defcamp/rev/memsome/"><a href="../../../defcamp/rev/memsome/">rev - memsome</a></li><li class="chapter"data-level="3.7.3"data-path="../../../defcamp/web/secops/"><a href="../../../defcamp/web/secops/">web - secops</a></li><li class="chapter"data-level="3.7.4"data-path="../../../defcamp/web/chat/"><a href="../../../defcamp/web/chat/">web - chat</a></li><li class="chapter"data-level="3.7.5"data-path="../../../defcamp/misc/voices/"><a href="../../../defcamp/misc/voices/">misc - voices</a></li></ul></li><li class="chapter"data-level="3.8"><span>HackIT</span><ul class="articles"><li class="chapter"data-level="3.8.1"data-path="../../../HackIT/coffee_overflow/"><a href="../../../HackIT/coffee_overflow/">rev - coffee_overflow</a></li></ul></li><li class="header">My Tasks</li><li class="header">2018</li><li class="chapter"data-level="5.1"><span>AIS3 Final</span><ul class="articles"><li class="chapter"data-level="5.1.1"data-path="../../../../../tasks/2018/ais3Final/crypto/100-mama/"><a href="../../../../../tasks/2018/ais3Final/crypto/100-mama/">crypto - mama</a></li><li class="chapter"data-level="5.1.2"data-path="../../../../../tasks/2018/ais3Final/crypto/200-secureSub/"><a href="../../../../../tasks/2018/ais3Final/crypto/200-secureSub/">crypto - secureSub</a></li><li class="chapter"data-level="5.1.3"data-path="../../../../../tasks/2018/ais3Final/crypto/300-xorlnarmoni'akda/"><a href="../../../../../tasks/2018/ais3Final/crypto/300-xorlnarmoni'akda/">crypto - xorlnarmoni'akda</a></li><li class="chapter"data-level="5.1.4"data-path="../../../../../tasks/2018/ais3Final/rev/100-SecDES/"><a href="../../../../../tasks/2018/ais3Final/rev/100-SecDES/">rev - SecDES</a></li><li class="chapter"data-level="5.1.5"data-path="../../../../../tasks/2018/ais3Final/rev/200-AlmightyDuctTape/"><a href="../../../../../tasks/2018/ais3Final/rev/200-AlmightyDuctTape/">rev - Almighty Duct Tape</a></li></ul></li><li class="divider"></li><li><a href="https://www.gitbook.com"class="gitbook-link"target="blank">Published with GitBook</a></li></ul></nav></div><div class="book-body"><div class="body-inner"><div class="book-header"role="navigation"><h1><i class="fa fa-circle-o-notch fa-spin"></i> <a href="../../../../..">task description</a></h1></div><div class="page-wrapper"role="main"tabindex="-1"><div class="page-inner"><div id="book-search-results"><div class="search-noresults"><section class="markdown-section normal"><div class="wpHeaderContainer"><h1 id="lfsr-streamcipher">LFSR StreamCipher</h1><div><span><a href="https://github.com/sasdf/ctf/blob/master/writeup/2018/Hack.lu/crypto/lfsr"target="_blank"><img alt="Attachments"src="https://img.shields.io/badge/-Attachments-lightgrey.svg?style=for-the-badge&amp;maxAge=3600&amp;logo=github"></a></span><span><img alt="crypto - 500"src="https://img.shields.io/badge/crypto-500-green.svg?style=for-the-badge&amp;maxAge=3600"></span><span><img alt="3 solves"src="https://img.shields.io/badge/solves-3-lightseagreen.svg?style=for-the-badge&amp;maxAge=3600"></span></div></div><h1 id="description">Description</h1><p>I was told you know something about crazy crypto?</p><p>Maybe you can help us out then. We are looking into these arcade machines from our rivaeehm friend. Eeh.. He &apos;lost&apos; his programming machines and his backups (of course he had backups) and asked us, if we can help him with reversing the code from his game machine. We were also already able to dump everything from the machine, but it is encrypted with some custom stream cipher, build in the hardware of the machine.</p><p>Our friend was able to.. remember some details of this stream cipher (after some longer &apos;interview&apos; we had). Apparently it is a filter generator with the following details:</p><pre class="language-"><code>Characteristic Polynomial: x^256 + x^10 + x^5 + x^2 + 1
Filter Function:
      x0*x64*x96*x128*x192*x255
    + x0*x64*x96*x128*x192
    + x0*x64*x96*x128
    + x0*x64*x96*x192
    + x0*x64*x128*x192*x255
    + x0*x64*x192*x255
    + x0*x64*x192
    + x0*x64*x255
    + x0*x96*x128*x192
    + x0*x96*x128*x255
    + x0*x96*x128
    + x0*x96*x192
    + x0*x128*x192*x255
    + x0*x128*x192
    + x0*x128*x255
    + x0*x128
    + x0*x192
    + x0*x255
    + x0
    + x64*x96*x128*x192*x255
    + x64*x96*x128*x192
    + x64*x96*x192
    + x64*x96*x255
    + x64*x128
    + x64*x192*x255
    + x64*x192
    + x64*x255
    + x64
    + x96*x128*x192*x255
    + x96*x128*x255
    + x96*x128
    + x96*x192*x255
    + x96*x192
    + x96*x255
    + x96
    + x128*x192*x255
</code></pre><p>(crazy guy that he is able to remember this nice filter function!) Luckily we were also able to extract the first keystream bits, because of the fileformat details our friend gave us:</p><p>First 1001 Output Key-Bits (LSB = 0th output, MSB = 1000th output):</p><pre class="language-"><code>0x131018c85020813093200c6ae4822e400261853722f054a1e0
80560034008605080380810640342825506829c0209a04134010
1b54f1848425aa208035d40510068044597575a02b115a900243
6958884d110a2515022240aec060e0a0200c4296081062829a00
328250210001533404b206301482800234000501d0104
</code></pre><p>But now we are stuck and need your help. Find the secret seed of the stream cipher so that we can decrypt the remaining game code and get our friend out of the jam.</p><h1 id="announcements-for-lfsr-streamcipher">Announcements for LFSR StreamCipher</h1><p>Thanks to a real friend of us, we found some more info about this strange LFSR. Its somewhat wiredly clocked:</p><pre class="language-"><code>new_x0 = old_x1
new_x1 = old_x2
...
new_x254 = old_x255
new_x255 = old_x0 + old_x2 + old_x5 + old_x10
</code></pre><p>And these output bits were also wrong. The right ones for seed 0x1 are (without filter function):</p><pre class="language-"><code>0x5c960484000000000000000000000000000000000000000000
0000000000000110401000000000000000000000000000000000
0000000000000000000000000148400000000000000000000000
0000000000000000000000000000000000000100000000000000
00000000000000000000000000000000000000000000000001
</code></pre></section></div><div class="search-results"><div class="has-results"><h1 class="search-results-title"><span class="search-results-count"></span> results matching "<span class="search-query"></span>"</h1><ul class="search-results-list"></ul></div><div class="no-results"><h1 class="search-results-title">No results matching "<span class="search-query"></span>"</h1></div></div></div></div></div></div><a href="./"class="navigation navigation-prev navigation-unique"aria-label="Previous page: crypto - LFSR StreamCipher"><i class="fa fa-angle-left"></i></a></div><script>var gitbook=gitbook||[];gitbook.push(function(){gitbook.page.hasChanged({page:{name:"LFSR StreamCipher",category:"crypto",points:500,solves:3,title:"task description",level:"3.4.3.1",depth:3,next:{title:"Hackover",level:"3.5",depth:1,ref:"",articles:[{title:"crypto - oblivious",level:"3.5.1",depth:2,path:"writeup/2018/HackOver/crypto/oblivious/README.md",ref:"writeup/2018/HackOver/crypto/oblivious/README.md",articles:[]},{title:"crypto - secure_hash_v2",level:"3.5.2",depth:2,path:"writeup/2018/HackOver/crypto/secure_hash_v2/README.md",ref:"writeup/2018/HackOver/crypto/secure_hash_v2/README.md",articles:[]},{title:"rev - flagmaker",level:"3.5.3",depth:2,path:"writeup/2018/HackOver/rev/flagmaker/README.md",ref:"writeup/2018/HackOver/rev/flagmaker/README.md",articles:[]}]},previous:{title:"crypto - LFSR StreamCipher",level:"3.4.3",depth:2,path:"writeup/2018/Hack.lu/crypto/lfsr/README.md",ref:"writeup/2018/Hack.lu/crypto/lfsr/README.md",articles:[{title:"task description",level:"3.4.3.1",depth:3,path:"writeup/2018/Hack.lu/crypto/lfsr/task.md",ref:"writeup/2018/Hack.lu/crypto/lfsr/task.md",articles:[]}]},dir:"ltr"},config:{gitbook:"*",theme:"default",variables:{},plugins:["katex@git://github.com/sasdf/plugin-katex.git","disqus","prism","-highlight","html-minifier","writeup-utils@git://github.com/sasdf/gitbook-plugin-writeup-utils.git"],pluginsConfig:{prism:{css:["prismjs/themes/prism-tomorrow.css"],lang:{C:"c","C++":"cpp",asm:"nasm"}},disqus:{useIdentifier:!1,shortName:"sasdfwriteup"},search:{},"html-minifier":{customAttrSurround:[],removeScriptTypeAttributes:!1,removeEmptyAttributes:!1,removeRedundantAttributes:!1,removeEmptyElements:!1,sortClassName:!0,caseSensitive:!0,html5:!0,collapseWhitespace:!0,processConditionalComments:!1,quoteCharacter:null,keepClosingSlash:!0,preventAttributesEscaping:!1,minifyURLs:!1,removeAttributeQuotes:!1,decodeEntities:!1,trimCustomFragments:!1,customAttrAssign:[],includeAutoGeneratedTags:!0,collapseInlineTagWhitespace:!1,collapseBooleanAttributes:!0,minifyJS:!0,removeTagWhitespace:!0,preserveLineBreaks:!1,sortAttributes:!0,removeStyleLinkTypeAttributes:!1,removeComments:!0,minifyCSS:!0,processScripts:[],conservativeCollapse:!1,removeOptionalTags:!1,useShortDoctype:!1},lunr:{maxIndexSize:1e6,ignoreSpecialCharacters:!1},katex:{},fontsettings:{theme:"white",family:"sans",size:2},sharing:{facebook:!0,twitter:!0,google:!1,weibo:!1,instapaper:!1,vk:!1,all:["facebook","google","twitter","weibo","instapaper"]},"theme-default":{styles:{website:"styles/website.css",pdf:"styles/pdf.css",epub:"styles/epub.css",mobi:"styles/mobi.css",ebook:"styles/ebook.css",print:"styles/print.css"},showLevel:!1},"writeup-utils":{filePrefix:"https://github.com/sasdf/ctf/blob/master",repoPrefix:"https://github.com/sasdf/ctf/blob/master"}},structure:{langs:"LANGS.md",readme:"README.md",glossary:"GLOSSARY.md",summary:"SUMMARY.md"},pdf:{pageNumbers:!0,fontSize:12,fontFamily:"Arial",paperSize:"a4",chapterMark:"pagebreak",pageBreaksBefore:"/",margin:{right:62,left:62,top:56,bottom:56}},styles:{website:"styles/website.css",pdf:"styles/pdf.css",epub:"styles/epub.css",mobi:"styles/mobi.css",ebook:"styles/ebook.css",print:"styles/print.css"}},file:{path:"writeup/2018/Hack.lu/crypto/lfsr/task.md",mtime:"2018-12-02T20:01:20.605Z",type:"markdown"},gitbook:{version:"3.2.3",time:"2018-12-09T14:37:49.444Z"},basePath:"../../../../..",book:{language:""}})})</script></div><script src="../../../../../gitbook/gitbook.js"></script><script src="../../../../../gitbook/theme.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/URI.js/1.16.1/URI.min.js"></script><script src="../../../../../gitbook/gitbook-plugin-disqus/plugin.js"></script><script src="../../../../../gitbook/gitbook-plugin-search/search-engine.js"></script><script src="../../../../../gitbook/gitbook-plugin-search/search.js"></script><script src="../../../../../gitbook/gitbook-plugin-lunr/lunr.min.js"></script><script src="../../../../../gitbook/gitbook-plugin-lunr/search-lunr.js"></script><script src="../../../../../gitbook/gitbook-plugin-sharing/buttons.js"></script><script src="../../../../../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script></body></html>