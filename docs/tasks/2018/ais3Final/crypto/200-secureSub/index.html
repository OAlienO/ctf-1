<!DOCTYPE HTML><html lang=""><head><meta charset="UTF-8"><meta content="text/html; charset=utf-8"http-equiv="Content-Type"><title>crypto - secureSub Â· GitBook</title><meta content="IE=edge"http-equiv="X-UA-Compatible"/><meta content=""name="description"><meta content="GitBook 3.2.3"name="generator"><link href="../../../../../gitbook/style.css"rel="stylesheet"><link href="../../../../../gitbook/gitbook-plugin-katex/katex.min.css"rel="stylesheet"><link href="../../../../../gitbook/gitbook-plugin-disqus/plugin.css"rel="stylesheet"><link href="../../../../../gitbook/gitbook-plugin-prism/prism-tomorrow.css"rel="stylesheet"><link href="../../../../../gitbook/gitbook-plugin-writeup-utils/plugin.css"rel="stylesheet"><link href="../../../../../gitbook/gitbook-plugin-search/search.css"rel="stylesheet"><link href="../../../../../gitbook/gitbook-plugin-fontsettings/website.css"rel="stylesheet"><meta content="true"name="HandheldFriendly"/><meta content="width=device-width,initial-scale=1,user-scalable=no"name="viewport"><meta content="yes"name="apple-mobile-web-app-capable"><meta content="black"name="apple-mobile-web-app-status-bar-style"><link href="../../../../../gitbook/images/apple-touch-icon-precomposed-152.png"rel="apple-touch-icon-precomposed"sizes="152x152"><link href="../../../../../gitbook/images/favicon.ico"rel="shortcut icon"type="image/x-icon"><link href="../300-xorlnarmoni'akda/"rel="next"/><link href="../100-mama/"rel="prev"/></head><body><div class="book"><div class="book-summary"><div role="search"id="book-search-input"><input placeholder="Type to search"type="text"/></div><nav role="navigation"><ul class="summary"><li class="chapter"data-level="1.1"data-path="../../../../../"><a href="../../../../../">Introduction</a></li><li class="header">Writeups</li><li class="header">2018</li><li class="chapter"data-level="3.1"><span>Hackover</span><ul class="articles"><li class="chapter"data-level="3.1.1"data-path="../../../../../writeup/2018/HackOver/crypto/oblivious/"><a href="../../../../../writeup/2018/HackOver/crypto/oblivious/">crypto - oblivious</a></li><li class="chapter"data-level="3.1.2"data-path="../../../../../writeup/2018/HackOver/crypto/secure_hash_v2/"><a href="../../../../../writeup/2018/HackOver/crypto/secure_hash_v2/">crypto - secure_hash_v2</a></li><li class="chapter"data-level="3.1.3"data-path="../../../../../writeup/2018/HackOver/rev/flagmaker/"><a href="../../../../../writeup/2018/HackOver/rev/flagmaker/">rev - flagmaker</a></li></ul></li><li class="chapter"data-level="3.2"><span>Teaser Dragon</span><ul class="articles"><li class="chapter"data-level="3.2.1"data-path="../../../../../writeup/2018/TeaserDragon/rev/Chains of trust/"><a href="../../../../../writeup/2018/TeaserDragon/rev/Chains of trust/">rev - Chains of trust</a></li></ul></li><li class="chapter"data-level="3.3"><span>Defcamp</span><ul class="articles"><li class="chapter"data-level="3.3.1"data-path="../../../../../writeup/2018/defcamp/rev/validator/"><a href="../../../../../writeup/2018/defcamp/rev/validator/">rev - validator</a></li><li class="chapter"data-level="3.3.2"data-path="../../../../../writeup/2018/defcamp/rev/memsome/"><a href="../../../../../writeup/2018/defcamp/rev/memsome/">rev - memsome</a></li><li class="chapter"data-level="3.3.3"data-path="../../../../../writeup/2018/defcamp/web/secops/"><a href="../../../../../writeup/2018/defcamp/web/secops/">web - secops</a></li><li class="chapter"data-level="3.3.4"data-path="../../../../../writeup/2018/defcamp/web/chat/"><a href="../../../../../writeup/2018/defcamp/web/chat/">web - chat</a></li><li class="chapter"data-level="3.3.5"data-path="../../../../../writeup/2018/defcamp/misc/voices/"><a href="../../../../../writeup/2018/defcamp/misc/voices/">misc - voices</a></li></ul></li><li class="chapter"data-level="3.4"><span>HackIT</span><ul class="articles"><li class="chapter"data-level="3.4.1"data-path="../../../../../writeup/2018/HackIT/coffee_overflow/"><a href="../../../../../writeup/2018/HackIT/coffee_overflow/">rev - coffee_overflow</a></li></ul></li><li class="header">My Tasks</li><li class="header">2018</li><li class="chapter"data-level="5.1"><span>AIS3 Final</span><ul class="articles"><li class="chapter"data-level="5.1.1"data-path="../100-mama/"><a href="../100-mama/">crypto - mama</a></li><li class="chapter active"data-level="5.1.2"data-path="./"><a href="./">crypto - secureSub</a></li><li class="chapter"data-level="5.1.3"data-path="../300-xorlnarmoni'akda/"><a href="../300-xorlnarmoni'akda/">crypto - xorlnarmoni'akda</a></li><li class="chapter"data-level="5.1.4"data-path="../../rev/100-SecDES/"><a href="../../rev/100-SecDES/">rev - SecDES</a></li><li class="chapter"data-level="5.1.5"data-path="../../rev/200-AlmightyDuctTape/"><a href="../../rev/200-AlmightyDuctTape/">rev - Almighty Duct Tape</a></li></ul></li><li class="divider"></li><li><a href="https://www.gitbook.com"class="gitbook-link"target="blank">Published with GitBook</a></li></ul></nav></div><div class="book-body"><div class="body-inner"><div class="book-header"role="navigation"><h1><i class="fa fa-circle-o-notch fa-spin"></i> <a href="../../../../..">crypto - secureSub</a></h1></div><div class="page-wrapper"role="main"tabindex="-1"><div class="page-inner"><div id="book-search-results"><div class="search-noresults"><section class="markdown-section normal"><div class="wpHeaderContainer"><h1 id="securesub">secureSub</h1><div><span><a href="https://github.com/sasdf/ctf-tasks-writeup/blob/master/tasks/2018/ais3Final/crypto/200-secureSub"target="_blank"><img alt="Attachments"src="https://img.shields.io/badge/-Attachments-lightgrey.svg?style=for-the-badge&amp;maxAge=3600&amp;logo=github"></a></span><span><img alt="crypto - 200"src="https://img.shields.io/badge/crypto-200-green.svg?style=for-the-badge&amp;maxAge=3600"> </span><span><img alt="0 solves"src="https://img.shields.io/badge/solves-0-blue.svg?style=for-the-badge&amp;maxAge=3600"></span></div></div><p></p><blockquote><p>Even a one-year-old baby can solve substitution cipher challenge with quipquip. So I made a secure version of substitution cipher that babies can&apos;t break it.</p></blockquote><h1 id="overview-concept-and-design-criteria">Overview, Concept and Design Criteria</h1><p>This challenge runs substitution cipher on encoded string, so online services like quipquip won&apos;t work. There are many articles about how to solve substitution cipher under base64, and that is why I choose uuencode rather than base64.</p><h1 id="solution">Solution</h1><h2 id="tldr">TL;DR</h2><p>Solve the substitution cipher with hill climbing / genetic algorithm.</p><p>A common method to solve substitution cipher (and many other classical cipher) is to model the task as an optimization problem: Given a fitness function on decrypted data, we want to find a key which maximize that fitness function. Since our plaintext is in English, we have to find some fitness function that measure how silmiar the decryped text is to English. There are many language model you can found on the Internet, and one popular option is ngram. To optimize our key, we can use hill climbing (or more sophisticated genetic algorithm) for approximating global optima.</p><p>You can find a implementation of hill climbing algorithm in <code>hill.py</code> and a implementation of genetic algorithm in <code>ga.py</code>, where genetic algorithm produce slightly better result than hill climbing and much more stable. In my solution, I choose trigram log probabilities from wikidump as fitness function. The mutation of key is randomly swapping two characters. It may converge to local optima, you may need to run it several times. The result isn&apos;t always perfect, but it is clear enough to fix it manually.</p></section></div><div class="search-results"><div class="has-results"><h1 class="search-results-title"><span class="search-results-count"></span> results matching "<span class="search-query"></span>"</h1><ul class="search-results-list"></ul></div><div class="no-results"><h1 class="search-results-title">No results matching "<span class="search-query"></span>"</h1></div></div></div></div></div></div><a href="../100-mama/"class="navigation navigation-prev"aria-label="Previous page: crypto - mama"><i class="fa fa-angle-left"></i> </a><a href="../300-xorlnarmoni'akda/"class="navigation navigation-next"aria-label="Next page: crypto - xorlnarmoni'akda"><i class="fa fa-angle-right"></i></a></div><script>var gitbook=gitbook||[];gitbook.push(function(){gitbook.page.hasChanged({page:{name:"secureSub",category:"crypto",points:200,solves:0,title:"crypto - secureSub",level:"5.1.2",depth:2,next:{title:"crypto - xorlnarmoni'akda",level:"5.1.3",depth:2,path:"tasks/2018/ais3Final/crypto/300-xorlnarmoni'akda/README.md",ref:"tasks/2018/ais3Final/crypto/300-xorlnarmoni'akda/README.md",articles:[]},previous:{title:"crypto - mama",level:"5.1.1",depth:2,path:"tasks/2018/ais3Final/crypto/100-mama/README.md",ref:"tasks/2018/ais3Final/crypto/100-mama/README.md",articles:[]},dir:"ltr"},config:{gitbook:"*",theme:"default",variables:{},plugins:["katex@git://github.com/sasdf/plugin-katex.git","disqus","prism","-highlight","html-minifier","writeup-utils@git://github.com/sasdf/gitbook-plugin-writeup-utils.git"],pluginsConfig:{prism:{css:["prismjs/themes/prism-tomorrow.css"],lang:{C:"c","C++":"cpp",asm:"nasm"}},disqus:{useIdentifier:!1,shortName:"sasdfwriteup"},search:{},"html-minifier":{customAttrSurround:[],removeScriptTypeAttributes:!1,removeEmptyAttributes:!1,removeRedundantAttributes:!1,removeEmptyElements:!1,sortClassName:!0,caseSensitive:!0,html5:!0,collapseWhitespace:!0,processConditionalComments:!1,quoteCharacter:null,keepClosingSlash:!0,preventAttributesEscaping:!1,minifyURLs:!1,removeAttributeQuotes:!1,decodeEntities:!1,trimCustomFragments:!1,customAttrAssign:[],includeAutoGeneratedTags:!0,collapseInlineTagWhitespace:!1,collapseBooleanAttributes:!0,minifyJS:!0,removeTagWhitespace:!0,preserveLineBreaks:!1,sortAttributes:!0,removeStyleLinkTypeAttributes:!1,removeComments:!0,minifyCSS:!0,processScripts:[],conservativeCollapse:!1,removeOptionalTags:!1,useShortDoctype:!1},lunr:{maxIndexSize:1e6,ignoreSpecialCharacters:!1},katex:{},fontsettings:{theme:"white",family:"sans",size:2},sharing:{facebook:!0,twitter:!0,google:!1,weibo:!1,instapaper:!1,vk:!1,all:["facebook","google","twitter","weibo","instapaper"]},"theme-default":{styles:{website:"styles/website.css",pdf:"styles/pdf.css",epub:"styles/epub.css",mobi:"styles/mobi.css",ebook:"styles/ebook.css",print:"styles/print.css"},showLevel:!1},"writeup-utils":{filePrefix:"https://github.com/sasdf/ctf-tasks-writeup/blob/master",repoPrefix:"https://github.com/sasdf/ctf-tasks-writeup/blob/master"}},structure:{langs:"LANGS.md",readme:"README.md",glossary:"GLOSSARY.md",summary:"SUMMARY.md"},pdf:{pageNumbers:!0,fontSize:12,fontFamily:"Arial",paperSize:"a4",chapterMark:"pagebreak",pageBreaksBefore:"/",margin:{right:62,left:62,top:56,bottom:56}},styles:{website:"styles/website.css",pdf:"styles/pdf.css",epub:"styles/epub.css",mobi:"styles/mobi.css",ebook:"styles/ebook.css",print:"styles/print.css"}},file:{path:"tasks/2018/ais3Final/crypto/200-secureSub/README.md",mtime:"2018-10-12T20:27:00.445Z",type:"markdown"},gitbook:{version:"3.2.3",time:"2018-10-12T21:20:34.867Z"},basePath:"../../../../..",book:{language:""}})})</script></div><script src="../../../../../gitbook/gitbook.js"></script><script src="../../../../../gitbook/theme.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/URI.js/1.16.1/URI.min.js"></script><script src="../../../../../gitbook/gitbook-plugin-disqus/plugin.js"></script><script src="../../../../../gitbook/gitbook-plugin-search/search-engine.js"></script><script src="../../../../../gitbook/gitbook-plugin-search/search.js"></script><script src="../../../../../gitbook/gitbook-plugin-lunr/lunr.min.js"></script><script src="../../../../../gitbook/gitbook-plugin-lunr/search-lunr.js"></script><script src="../../../../../gitbook/gitbook-plugin-sharing/buttons.js"></script><script src="../../../../../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script></body></html>